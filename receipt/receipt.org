# -*- mode: org -*-

#+EXPORT_FILE_NAME: ./README.md
#+OPTIONS: toc:nil
#+PROPERTY: mkdirp yes
#+STARTUP: content

* Receipt

#+begin_example
Accept: application/json
Accept: application/xml
Accept: application/vnd.eci.stg.receipt.json
Accept: application/vnd.eci.stg.receipt.xml
Accept: application/vnd.eci.stg.receipt-1.5.0.json
Accept: application/vnd.eci.stg.receipt-1.5.0.xml
#+end_example

** Testing and Test Results

#+begin_src shell :exports both :results table replace
  echo $(date -u +"%Y-%m-%dT%H:%M:%SZ") started
  xmllint --noout --schema ../rsrc-schema/src/vnd.eci.stg.receipt.1.5.0.xsd ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.?-*.xml 2>&1
  ajv -s ../rsrc-schema/src/vnd.eci.stg.receipt.1.5.0.json -d "../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.?-*.json" 2>&1
  echo $(date -u +"%Y-%m-%dT%H:%M:%SZ") stopped
#+end_src

** Overview

#+begin_src plantuml :file ../images/receipt-sequence.puml.png :exports results
  @startuml receipt-sequence.png
  Seller -> Buyer : [ POST ] receipt
  @enduml
#+end_src

In the following section, Use Cases, examples of data ( ~--data~ ) to be sent and
received will be shown. It is assumed that the caller will make the actual /POST/
call with the required headers e.g.

#+begin_src shell
  curl --request POST \
       --header "Content-Type: application/vnd.eci.stg.receipt.1.5.0.xml; charset=utf-8" \
       --user user123:password123 \
       --basic \
       --url http://vendor-host/vendor-receipt-endpoint
       --data ''
#+end_src

** Definition of Terms

** Example

Let us assume the Buyer has placed the following order in the code block below. When the order has
been fulfilled and shipped the Seller will POST a shipping receipt providing tracking information.
In this case, we are going to show two shipments from the same carrier with tracking numbers
*T-LMNOP-123* and *T-XYZ-456*. In the section below called UseCases, we will demonstrate other ways
the receipt can be expressed.

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-example-order.json
  { "reference": { "referencesCount": 2,
                   "references": [{ "code": "PO-ABC123-2",
                                    "type": "buyer" },
                                  { "code": "PO-XYZ-a",
                                    "type": "consumer" }]},

    "buyer": { "reference": { "code": "buyer-abc",
                              "type": "seller" }},

    "shipTo": { "location": { "mtn": "Jane Doe",
                              "rcp": "ECI Solutions, STG",
                              "alt": "Suite #200",
                              "dal": "4626 N 300 W",
                              "city": "Provo",
                              "region": "UT",
                              "postalCode": "84604" },
                "email": "shipping-contact@example.com",
                "phone": "1-555-555-5555" },

    "itemsCount": 1,
    "items": [{ "reference": { "code": "abc-123",
                               "type": "seller" },
                "quantity": 24,
                "unitCost": 24.99 }]}
#+end_src

*** Request

**** JSON

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-example-request.json
  { "reference": { "referencesCount": 2,
                   "references": [{ "code": "PO-2159403-2",
                                    "type": "buyer" },
                                  { "code": "PO-abc-q",
                                    "type": "consumer" }]},
    "when": "2018-04-24T17:00:00.000Z",
    "whenExpected": "2018-04-26T17:11:30.000Z",
    "buyer": { "reference": { "code": "buyer-abc",
                              "type": "seller" }},

    "shipTo": { "location": { "mtn": "Jane Doe",
                              "rcp": "ECI Solutions, STG",
                              "alt": "Suite #200",
                              "dal": "4626 N 300 W",
                              "city": "Provo",
                              "region": "UT",
                              "postalCode": "84604" },
                "email": "shipping-contact@example.com",
                "phone": "1-555-555-5555" },

    "shippingMethod": { "code": "shipper-123",
                        "name": "usps-2day" },

    "itemsCount": 2,
    "items": [{ "reference": { "code": "abc-123",
                               "type": "seller" },
                "quantity": 20,
                "tracking": "T-LMNOP-123" },
              { "reference": { "code": "abc-123",
                               "type": "seller" },
                "quantity": 4,
                "tracking": "T-XYZ-456" }]}
#+end_src

**** XML

#+begin_src xml :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-example-request.xml
  <receipt>
    <reference>
      <referencesCount>2</referencesCount>
      <references>
        <reference>
          <code>PO-2159403-2</code>
          <type>buyer</type>
        </reference>
        <reference>
          <code>PO-abc-q</code>
          <type>consumer</type>
        </reference>
      </references>
    </reference>

    <buyer>
      <reference>
        <code>buyer-abc</code>
        <type>seller</type>
      </reference>
    </buyer>

    <shipTo>
      <location>
        <mtn>Jane Doe</mtn>
        <rcp>ECI Solutions, STG</rcp>
        <alt>Suite #200</alt>
        <dal>4626 N 300 W"</dal>
        <city>Provo</city>
        <region>UT</region>
        <postalCode>84604</postalCode>
      </location>
      <email>shipping-contact@example.com></email>
      <phone>1-555-555-5555</phone>
    </shipTo>

    <shippingMethod>
        <code>shipper-123</code>
        <name>usps-2day</name>
    </shippingMethod>

    <when>2018-04-24T17:00:00.000Z</when>
    <whenExpected>2018-04-26T17:11:30.000Z</whenExpected>

    <itemsCount>2</itemsCount>
    <items>
      <item>
        <reference>
          <code>abc-123</code>
          <type>seller</type>
        </reference>
        <quantity>20</quantity>
        <tracking>T-LMNOP-123</tracking>
      </item>
      <item>
        <reference>
          <code>abc-123</code>
          <type>seller</type>
        </reference>
        <quantity>4</quantity>
        <tracking>T-XYZ-456</tracking>
      </item>
    </items>
  </receipt>

#+end_src

** Use Cases

All of the receipt use cases will be based off of the following order:

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-usecase-order.json
  { "reference": { "referencesCount": 2,
                   "references": [ { "code": "PO-ABC123-2",
                                     "type": "buyer" },
                                   { "code": "PO-XYZ-a",
                                     "type": "consumer" }]},

    "buyer": { "reference": { "code": "buyer-abc",
                              "type": "seller" }},

    "shipTo": { "location": { "mtn": "Jane Doe",
                              "rcp": "ECI Solutions, STG",
                              "alt": "Suite #200",
                              "dal": "4626 N 300 W",
                              "city": "Provo",
                              "region": "UT",
                              "postalCode": "84604" },
                "email": "shipping-contact@example.com",
                "phone": "1-555-555-5555" },

    "itemsCount": 3,
    "items": [{ "reference": { "code": "abc-123",
                               "type": "seller" },
                "quantity": 24,
                "unitCost": 24.99 },
              { "reference": { "code": "def-456",
                               "type": "seller" },
                "quantity": 2,
                "unitCost": 2.99 },
              { "reference": { "code": "ghi-789",
                               "type": "seller" },
                "quantity": 1,
                "unitCost": 1.99 }]}
#+end_src

*** As a seller I would like to provide a single tracking number (T-123-ABC) a single order (PO-ABC123-2)

**** Single Order, Single Receipt, No Order Lines

***** JSON

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-single-order-single-receipt-no-items.json
  { "reference": { "referencesCount": 2,
                   "references": [{ "code": "PO-ABC123-2",
                                    "type": "buyer" },
                                  { "code": "PO-XYZ-a",
                                    "type": "consumer" }]},

    "when": "2018-04-24T17:00:00.000Z",
    "whenExpected": "2018-04-26T17:11:30.000Z",
    "tracking": "T-123-ABC" }
#+end_src

**** Tracking Number with Order Lines

***** JSON

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-single-order-single-receipt-items.json
  { "reference": { "referencesCount": 2,
                   "references": [ { "code": "PO-ABC123-2",
                                     "type": "buyer" },
                                   { "code": "PO-XYZ-a",
                                     "type": "consumer" }]},

    "when": "2018-04-24T17:00:00.000Z",
    "whenExpected": "2018-04-26T17:11:30.000Z",
    "tracking": "T-123-ABC",

    "itemsCount": 2,
    "items": [{ "reference": { "code": "abc-123",
                               "type": "seller" },
                "quantity": 24,
                "unitCost": 24.99 },
              { "reference": { "code": "def-456",
                               "type": "seller" },
                "quantity": 2,
                "unitCost": 2.99 },
              { "reference": { "code": "ghi-789",
                               "type": "seller" },
                "quantity": 1,
                "unitCost": 1.99 }]}
#+end_src

*** As a seller I would like to provide two tracking numbers (T-123-ABC, T-456-DEF) for a single order (PO-ABC123-2)

**** Single Order, Many Shipments, Single Receipt

***** JSON

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-single-order-many-shipments-single-receipt.json
  { "reference": { "referencesCount": 2,
                   "references": [ { "code": "PO-ABC123-2",
                                     "type": "buyer" },
                                   { "code": "PO-XYZ-a",
                                     "type": "consumer" }]},

    "buyer": { "reference": { "code": "buyer-abc",
                              "type": "seller" }},

    "shipTo": { "location": { "mtn": "Jane Doe",
                              "rcp": "ECI Solutions, STG",
                              "alt": "Suite #200",
                              "dal": "4626 N 300 W",
                              "city": "Provo",
                              "region": "UT",
                              "postalCode": "84604" },
                "email": "shipping-contact@example.com",
                "phone": "1-555-555-5555" },

    "itemsCount": 3,
    "items": [{ "reference": { "code": "abc-123",
                               "type": "seller" },
                "quantity": 24,
                "unitCost": 24.99,
                "when": "2018-04-24T17:00:00.000Z",
                "whenExpected": "2018-04-26T17:11:30.000Z",
                "tracking": "T-123-ABC" },
              { "reference": { "code": "def-456",
                               "type": "seller" },
                "quantity": 2,
                "unitCost": 2.99,
                "when": "2018-04-24T17:00:00.000Z",
                "whenExpected": "2018-04-26T17:11:30.000Z",
                "tracking": "T-123-ABC" },
              { "reference": { "code": "ghi-789",
                               "type": "seller" },
                "quantity": 1,
                "unitCost": 1.99,
                "when": "2018-04-24T17:00:00.000Z",
                "whenExpected": "2018-04-26T17:11:30.000Z",
                "tracking": "T-456-DEF" }]}
#+end_src

**** Single Order, Many Shipments, Many Receipts

***** JSON

POST first tracking number (T-123-ABC)

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-single-order-many-shipments-many-receipts.json-1.json
  { "reference": { "referencesCount": 2,
                   "references": [{ "code": "PO-ABC123-2",
                                    "type": "buyer" },
                                  { "code": "PO-XYZ-a",
                                    "type": "consumer" }]},

    "when": "2018-04-24T17:00:00.000Z",
    "whenExpected": "2018-04-26T17:11:30.000Z",
    "tracking": "T-123-ABC",

    "itemsCount": 2,
    "items": [{ "reference": { "code": "abc-123",
                               "type": "seller"},
                "quantity": 24,
                "unitCost": 24.99 },
              { "reference": { "code": "def-456",
                               "type": "seller" },
                "quantity": 2,
                "unitCost": 2.99 },
              { "reference": { "code": "ghi-789",
                               "type": "seller" }}]}

#+end_src

POST second tracking number (T-456-DEF)

#+begin_src json :tangle ../rsrc-schema/tst/vnd.eci.stg.receipt.1.5.0-single-order-many-shipments-many-receipts.json-2.json
  { "reference": { "referencesCount": 2,
                   "references": [ { "code": "PO-ABC123-2",
                                     "type": "buyer" },
                                   { "code": "PO-XYZ-a",
                                     "type": "consumer" }]},

    "when": "2018-04-24T17:00:00.000Z",
    "whenExpected": "2018-04-26T17:11:30.000Z",
    "tracking": "T-456-DEF",

    "itemsCount": 1,
    "items": [
      { "reference": { "code": "ghi-789",
                       "type": "seller" },
        "quantity": 1,
        "unitCost": 1.99 }]}
#+end_src

** Resource Schemas

*** Version 1.0

No longer published

*** Version 1.5

**** JSON

#+begin_src json :tangle ../rsrc-schema/src/vnd.eci.stg.receipt.1.5.0.json
  {
    "id": "./vnd.eci.stg.receipt.1.5.0.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "receipt",
    "description": "",
    "type": "object",
    "additionalProperties": false,
    "properties": {

      "reference": { "$ref": "#/definitions/reference" },

      "name": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 32
      },

      "description": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 128
      },

      "remarks": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 256
      },

      "make": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 32
      },

      "model": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 32
      },

      "serialnumber": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 32
      },

      "buyer": { "$ref": "#/definitions/buyer" },

      "consumer": { "$ref": "#/definitions/consumer" },

      "seller": { "$ref": "#/definitions/seller" },

      "shipTo": { "$ref": "#/definitions/shipTo" },

      "billTo": { "$ref": "#/definitions/billTo" },

      "shippingMethod": { "$ref": "#/definitions/shippingMethod" },

      "location": { "$ref": "#/definitions/address" },

      "quantity": {
        "description": "",
        "type": "number",
        "minimum": 0,
        "maximum": 999999999.999999
      },

      "currency": { "$ref": "#/definitions/currency"},

      "unitCost": {
        "description": "",
        "type": "number",
        "minimum": 0,
        "maximum": 999999999999.999999
      },

      "total": { "$ref": "#/definitions/total"},

      "when": {
        "description": "",
        "type": "string",
        "format": "date-time"
      },

      "whenExpected": {
        "description": "",
        "type": "string",
        "format": "date-time"
      },

      "order": {
        "description": "",
        "$ref": "#/definitions/reference"
      },

      "package": {
        "description": "",
        "type": "integer",
        "minimum": 1
      },

      "shipment": {
        "description": "",
        "type": "integer",
        "minimum": 1
      },

      "tracking": {
        "description": "",
        "type": "string",
        "minLength": 1,
        "maxLength": 32
      },

      "itemsCount": {
        "description": "number of things in the items collection",
        "type": "number",
        "minimum": 1,
        "maximum": 1000
      },

      "items": {
        "description": "",
        "type": "array",
        "minItems": 1,
        "maxItems": 1000,
        "uniqueItems": true,
        "items": {
          "$ref": "#"
        }
      }
    },

    "definitions": {
      "reference": {
        "type": "object",
        "additionalProperties": false,

        "properties": {

          "code": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "type": { "$ref": "#/definitions/referenceTypeEnum" },

          "referencesCount": {
            "description": "number of things in the references collection",
            "type": "number",
            "minimum": 1,
            "maximum": 1000
          },

          "references": {
            "description": "",
            "type": "array",
            "minItems": 1,
            "maxItems": 1000,
            "uniqueItems": true,
            "items": {
              "$ref": "#/definitions/reference"
            }
          }
        }
      },

      "referenceTypeEnum": {
        "type": "string",
        "enum": ["buyer", "consumer", "manufacturer", "seller" ]
      },

      "tax": {
        "type": "object",
        "properties": {

          "code": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "amount": {
            "description": "",
            "type": "number",
            "minimum": 0,
            "maximum": 999999999999.999999
          },

          "authority": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "itemsCount": {
            "description": "number of things in the items collection",
            "type": "number",
            "minimum": 1,
            "maximum": 1000
          },

          "items": {
            "description": "",
            "type": "array",
            "minItems": 1,
            "maxItems": 1000,
            "uniqueItems": true,
            "items": {
              "$ref": "#/definitions/tax"
            }
          }
        },

        "additionalProperties": false
      },

      "shippingMethod": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "code": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "itemsCount": {
            "description": "number of shipping receipts in the collection",
            "type": "number",
            "minimum": 1,
            "maximum": 1000
          },

          "items": {
            "description": "",
            "type": "array",
            "minItems": 1,
            "maxItems": 1000,
            "uniqueItems": true,
            "items": {
              "$ref": "#/definitions/shippingMethod"
            }
          }
        }
      },

      "address": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "reference": { "$ref": "#/definitions/reference" },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "msc": {
            "description": "mail stop code",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "mtn": {
            "description": "attention line",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "rcp": {
            "description": "recipient or business name",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "alt": {
            "description": "alternate location",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "dal": {
            "description": "delivery address line",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "city": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "region": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "postalCode": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "country": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "binLocation": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 40
          },

          "warehouse": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          }
        }
      },

      "billTo": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "reference": { "$ref": "#/definitions/reference" },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "location": { "$ref": "#/definitions/address" },

          "email": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "phone": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "taxID": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          }
        }
      },

      "buyer": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "reference": { "$ref": "#/definitions/reference" },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "location": { "$ref": "#/definitions/address" },

          "email": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "phone": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "taxID": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          }
        }
      },

      "consumer": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "reference": { "$ref": "#/definitions/reference" },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "location": { "$ref": "#/definitions/address" },

          "contract": { "$ref": "#/definitions/reference" },

          "email": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "phone": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "taxID": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          }
        }
      },

      "seller": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "reference": { "$ref": "#/definitions/reference" },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "location": { "$ref": "#/definitions/address" },

          "email": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "phone": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "taxID": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          }
        }
      },

      "shipTo": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "reference": { "$ref": "#/definitions/reference" },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "description": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 128
          },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "location": { "$ref": "#/definitions/address" },

          "email": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          },

          "phone": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "isDropShip": {
            "description": "",
            "type": "boolean"
          }
        }
      },

      "currency": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "code": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "name": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 32
          },

          "number": {
            "description": "",
            "type": "number",
            "minimum": 1,
            "maximum": 999
          },

          "precision": {
            "description": "",
            "type": "number",
            "minimum": 0,
            "maximum": 18
          },

          "scale": {
            "description": "",
            "type": "number",
            "minimum": 1,
            "maximum": 6
          }
        }
      },

      "total": {
        "type": "object",
        "additionalProperties": false,
        "properties": {

          "amount": {
            "description": "",
            "type": "number",
            "minimum": 0,
            "maximum": 999999999999.999999
          },

          "discountAmount": {
            "description": "",
            "type": "number",
            "minimum": 0,
            "maximum": 999999999999.999999
          },

          "freightAmount": {
            "description": "",
            "type": "number",
            "minimum": 0,
            "maximum": 999999999999.999999
          },

          "termsAmount": {
            "description": "",
            "type": "number",
            "minimum": 0,
            "maximum": 999999999999.999999
          },

          "tax": { "$ref": "#/definitions/tax" },

          "remarks": {
            "description": "",
            "type": "string",
            "minLength": 1,
            "maxLength": 256
          }
        }
      }
    }
  }
#+end_src

**** XML

#+begin_src xml :tangle ../rsrc-schema/src/vnd.eci.stg.receipt.1.5.0.xsd
          <?xml version='1.0' encoding='utf-8'?>

          <xs:schema xmlns:xs='http://www.w3.org/2001/XMLSchema'
                     elementFormDefault='qualified'
                     xml:lang='en'>

            <xs:element name='receipt' type='ItemType'/>

            <xs:complexType name='AddressType'>
              <xs:sequence>
                <xs:element name='reference'   type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='msc'         type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='mtn'         type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='rcp'         type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='alt'         type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='dal'         type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='city'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='region'      type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='postalCode'  type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='country'     type='xs:string'     minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='BillToType'>
              <xs:sequence>
                <xs:element name='reference'   type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='location'    type='AddressType'   minOccurs='0' maxOccurs='1' />
                <xs:element name='email'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='phone'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='taxID'       type='xs:string'     minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='BuyerType'>
              <xs:sequence>
                <xs:element name='reference'   type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='location'    type='AddressType'   minOccurs='0' maxOccurs='1' />
                <xs:element name='email'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='phone'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='taxID'       type='xs:string'     minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>
            <xs:complexType name='ConsumerType'>
              <xs:sequence>
                <xs:element name='reference'   type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='location'    type='AddressType'   minOccurs='0' maxOccurs='1' />
                <xs:element name='contract'    type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='email'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='phone'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='taxID'       type='xs:string'     minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='CurrencyType'>
              <xs:sequence>
                <xs:element name='code'      type='xs:string'  />
                <xs:element name='name'      type='xs:string'  />
                <xs:element name='number'    type='xs:integer' />
                <xs:element name='precision' type='xs:integer' />
                <xs:element name='scale'     type='xs:integer' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='ItemType'>
              <xs:sequence>
                <xs:element name='reference'       type='ReferenceType'      minOccurs='0' maxOccurs='1' />
                <xs:element name='name'            type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='description'     type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'         type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='location'        type='AddressType'        minOccurs='0' maxOccurs='1' />
                <xs:element name='buyer'           type='BuyerType'          minOccurs='0' maxOccurs='1' />
                <xs:element name='consumer'        type='ConsumerType'       minOccurs='0' maxOccurs='1' />
                <xs:element name='seller'          type='SellerType'         minOccurs='0' maxOccurs='1' />
                <xs:element name='shipTo'          type='ShipToType'         minOccurs='0' maxOccurs='1' />
                <xs:element name='billTo'          type='BillToType'         minOccurs='0' maxOccurs='1' />
                <xs:element name='shippingMethod'  type='ShippingMethodType' minOccurs='0' maxOccurs='1' />
                <xs:element name='when'            type='xs:dateTime'        minOccurs='0' maxOccurs='1' />
                <xs:element name='whenExpected'    type='xs:dateTime'        minOccurs='0' maxOccurs='1' />
                <xs:element name='lineNumber'      type='xs:integer'         minOccurs='0' maxOccurs='1' />
                <xs:element name='make'            type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='model'           type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='serialNumber'    type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='quantity'        type='xs:float'           minOccurs='0' maxOccurs='1' />
                <xs:element name='unitCost'        type='MoneyType'          minOccurs='0' maxOccurs='1' />
                <xs:element name='unitMeasure'     type='UnitMeasureType'    minOccurs='0' maxOccurs='1' />
                <xs:element name='total'           type='TotalType'          minOccurs='0' maxOccurs='1' />
                <xs:element name='currency'        type='CurrencyType'       minOccurs='0' maxOccurs='1' />
                <xs:element name='order'           type='ReferenceType'      minOccurs='0' maxOccurs='1' />
                <xs:element name='package'         type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='shipment'        type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='tracking'        type='xs:string'          minOccurs='0' maxOccurs='1' />
                <xs:element name='itemsCount'      type='xs:integer'         minOccurs='0' maxOccurs='1' />
                <xs:element name='items'           type='ItemsType'          minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='ItemsType'>
              <xs:sequence minOccurs='1' maxOccurs='5000'>
                <xs:element name='item' type='ItemType'/>
              </xs:sequence>
            </xs:complexType>

            <xs:simpleType name='MoneyType'>
              <xs:annotation>
                <xs:documentation>
                  Every Product must have a unit cost that is equal to or greater than
                  0 and must cost just under one trillion monetary units. Version 1.5.0
                  assumes the monetary unit is US Dollars.
                </xs:documentation>
              </xs:annotation>
              <xs:restriction base='xs:decimal'>
                <xs:minInclusive value='0'/>
                <xs:maxInclusive value='999999999999.999999'/>
                <xs:fractionDigits value='6'/>
                <xs:totalDigits value='18'/>
              </xs:restriction>
            </xs:simpleType>

            <xs:complexType name='ReferenceType'>
              <xs:sequence>
                <xs:element name='code'        type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='type'        type='ReferenceTypeEnum' minOccurs='0' maxOccurs='1' />

                <xs:element name='referencesCount' type='xs:integer'     minOccurs='0' maxOccurs='1' />
                <xs:element name='references'      type='ReferencesType' minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:simpleType name='ReferenceTypeEnum'>
              <xs:restriction base='xs:string'>
                <xs:enumeration value='buyer'/>
                <xs:enumeration value='consumer'/>
                <xs:enumeration value='manufacturer'/>
                <xs:enumeration value='seller'/>
              </xs:restriction>
            </xs:simpleType>

            <xs:complexType name='ReferencesType'>
              <xs:sequence minOccurs='0' maxOccurs='1000'>
                <xs:element name='reference' type='ReferenceType'/>
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='SellerType'>
              <xs:sequence>
                <xs:element name='reference'   type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='location'    type='AddressType'   minOccurs='0' maxOccurs='1' />
                <xs:element name='email'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='phone'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='taxID'       type='xs:string'     minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='ShippingMethodType'>
              <xs:sequence>
                <xs:element name='code'        type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string' minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string' minOccurs='0' maxOccurs='1' />

                <xs:element name='itemsCount' type='xs:integer'          minOccurs='0' maxOccurs='1' />
                <xs:element name='items'      type='ShippingMethodsType' minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='ShippingMethodsType'>
              <xs:sequence minOccurs='0' maxOccurs='1000'>
                <xs:element name='shippingMethod' type='ReferenceType'/>
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='ShipToType'>
              <xs:sequence>
                <xs:element name='reference'   type='ReferenceType' minOccurs='0' maxOccurs='1' />
                <xs:element name='name'        type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='description' type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'     type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='location'    type='AddressType'   minOccurs='0' maxOccurs='1' />
                <xs:element name='email'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='phone'       type='xs:string'     minOccurs='0' maxOccurs='1' />
                <xs:element name='isDropShip'  type='xs:boolean'    minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='TaxType'>
              <xs:sequence>
                <xs:element name='code'            type='xs:string'  minOccurs='0' maxOccurs='1' />
                <xs:element name='name'            type='xs:string'  minOccurs='0' maxOccurs='1' />
                <xs:element name='description'     type='xs:string'  minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'         type='xs:string'  minOccurs='0' maxOccurs='1' />
                <xs:element name='amount'          type='MoneyType'  minOccurs='0' maxOccurs='1' />
                <xs:element name='authority'       type='xs:string'  minOccurs='0' maxOccurs='1' />
                <xs:element name='itemsCount'      type='xs:integer' minOccurs='0' maxOccurs='1' />
                <xs:element name='items'           type='ItemsType'  minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='TotalType'>
              <xs:sequence>
                <xs:element name='amount'         type='MoneyType' minOccurs='0' maxOccurs='1' />
                <xs:element name='discountAmount' type='MoneyType' minOccurs='0' maxOccurs='1' />
                <xs:element name='freightAmount'  type='MoneyType' minOccurs='0' maxOccurs='1' />
                <xs:element name='termsAmount'    type='MoneyType' minOccurs='0' maxOccurs='1' />
                <xs:element name='tax'            type='TaxType'   minOccurs='0' maxOccurs='1' />
                <xs:element name='remarks'        type='xs:string' minOccurs='0' maxOccurs='1' />
              </xs:sequence>
            </xs:complexType>

            <xs:complexType name='UnitMeasureType'>
              <xs:sequence>
                <xs:element name='name'        type='xs:string'  />
                <xs:element name='description' type='xs:string'  />
                <xs:element name='remarks'     type='xs:string'  />
                <xs:element name='code'        type='xs:string'  />
                <xs:element name='quantity'    type='xs:decimal' />
              </xs:sequence>
            </xs:complexType>

          </xs:schema>

#+end_src

** Â© 2018-2019 ECI Software Solutions, Inc. All rights reserved.
